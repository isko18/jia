{% load i18n jazzmin %}
{% get_jazzmin_ui_tweaks as jazzmin_ui %}

<div class="actions">
    {% block actions %}
        {% block actions-form %}
            {% for field in action_form %}<label>{{ field }}</label>{% endfor %}
        {% endblock %}
        {% block actions-submit %}
            <button type="submit" class="btn {{ jazzmin_ui.button_classes.primary }}" style="margin-right: 5px; margin-left: 15px;" title="{% trans "Run the selected action" %}" name="index" value="{{ action_index|default:0 }}">
                {% trans "Go" %}
            </button>
        {% endblock %}
        {% block actions-counter %}
            {% if actions_selection_counter %}
                <span class="action-counter" data-actions-icnt="{{ cl.result_list|length }}">{{ selection_note }}</span>
                {% if cl.result_count != cl.result_list|length %}
                    <span class="all hidden">{{ selection_note_all }}</span>
                    <span class="question hidden">
                        <a href="#" title="{% trans "Click here to select the objects across all pages" %}">
                            {% blocktrans with cl.result_count as total_count %}Select all {{ total_count }} {{ module_name }}{% endblocktrans %}
                        </a>
                    </span>
                    <span class="clear" style="display: none;"><a href="#">{% trans "Clear selection" %}</a></span>
                {% endif %}
            {% endif %}
        {% endblock %}

        <!-- Дропдаун меню для скачивания Excel файлов -->
        <div class="btn-group">
            <button type="button" class="btn {{ jazzmin_ui.button_classes.primary }} dropdown-toggle" id="downloadDropdown">
                {% trans "Скачать Excel файл" %}
            </button>
            <ul class="dropdown-menu" id="downloadMenu" aria-labelledby="downloadDropdown">
                <li><a class="dropdown-item" href="{% url 'admin:download_excel' %}">{% trans "Связаться Excel файл" %}</a></li>
                <li><a class="dropdown-item" href="{% url 'admin:download_excel_standart' %}">{% trans "Standart Excel файл" %}</a></li>
                <li><a class="dropdown-item" href="{% url 'admin:download_excel_vip' %}">{% trans "VIP Excel файл" %}</a></li>
            </ul>
        </div>

        <!-- Дропдаун меню для просмотра Excel файлов -->
        <div class="btn-group">
            <button type="button" class="btn {{ jazzmin_ui.button_classes.secondary }} dropdown-toggle" id="viewDropdown">
                {% trans "Смотреть Excel файл" %}
            </button>
            <ul class="dropdown-menu" id="viewMenu" aria-labelledby="viewDropdown">
                <li><a class="dropdown-item" href="{% url 'admin:view_excel' %}">{% trans "Связаться Excel файл" %}</a></li>
                <li><a class="dropdown-item" href="{% url 'admin:view_excel_standart' %}">{% trans "Standart Excel файл" %}</a></li>
                <li><a class="dropdown-item" href="{% url 'admin:view_excel_vip' %}">{% trans "VIP Excel файл" %}</a></li>
            </ul>
        </div>
        
    {% endblock %}
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const downloadDropdown = document.getElementById('downloadDropdown');
        const downloadMenu = document.getElementById('downloadMenu');
        const viewDropdown = document.getElementById('viewDropdown');
        const viewMenu = document.getElementById('viewMenu');

        // Обработка кликов по кнопке "Скачать Excel файл"
        downloadDropdown.addEventListener('click', function() {
            toggleDropdown(downloadMenu);
        });

        // Обработка кликов по кнопке "Смотреть Excel файл"
        viewDropdown.addEventListener('click', function() {
            toggleDropdown(viewMenu);
        });

        // Функция для переключения видимости меню
        function toggleDropdown(menu) {
            const isVisible = menu.style.display === 'block';
            // Скрываем все дропдауны перед открытием
            downloadMenu.style.display = 'none';
            viewMenu.style.display = 'none';
            menu.style.display = isVisible ? 'none' : 'block';
        }

        // Закрываем меню при клике вне дропдауна
        document.addEventListener('click', function(event) {
            if (!downloadDropdown.contains(event.target)) {
                downloadMenu.style.display = 'none';
            }
            if (!viewDropdown.contains(event.target)) {
                viewMenu.style.display = 'none';
            }
        });
    });
</script>

<style>
    .dropdown-menu {
        display: none;
        position: absolute;
        background-color: white;
        box-shadow: 0px 8px 16px rgba(0, 0, 0, 0.2);
        z-index: 1;
        min-width: 160px;
    }

    .dropdown-item {
        padding: 12px 16px;
        display: block;
        text-decoration: none;
        color: black;
    }

    .dropdown-item:hover {
        background-color: #ddd;
    }
</style>
